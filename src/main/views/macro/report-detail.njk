{% from "govuk/components/input/macro.njk" import govukInput %}
{% from "govuk/components/date-input/macro.njk" import govukDateInput %}
{% from "govuk/components/fieldset/macro.njk" import govukFieldset %}

{% macro reportDetail(reportDetailIndex, reportDetailValue, errorFor, t) %}

  {% call govukFieldset({
    classes: 'moj-add-another__item govuk-!-margin-bottom-6',
    legend: {
      text: 'Person',
      classes: 'moj-add-another__title govuk-fieldset__legend--m',
      isPageHeading: false
    }
  }) %}


    {{ govukInput({
      id: 'reportDetails[' + reportDetailIndex + '][expertName]',
      name: 'reportDetails[' + reportDetailIndex + '][expertName]',
      value: reportDetailValue.expertName,
      type: 'text',
      label: {
        text: t('PAGES.EXPERT_REPORT_DETAILS.EXPERT_NAME')
      },
      attributes: {
        'data-name': 'reportDetails[%index%][claimNumber]',
        'data-id': 'reportDetails[%index%][claimNumber]'
      },
      errorMessage: {
        text: t(errorFor('reportDetails['+reportDetailIndex+'][expertName]'))
      } if errorFor('reportDetails['+reportDetailIndex+'][expertName]')
    }) }}

     {{ govukDateInput({
                id: 'reportDetails[' + reportDetailIndex + '][reportDate]',
                type: "number",
                inputmode: "numeric",
                name: 'reportDetails[' + reportDetailIndex + '][reportDate]',
                fieldset: {
                  legend: {
                    isPageHeading: false,
                    classes: 'govuk-fieldset__legend--m'
                  }
                },
                hint: {
        text: "For example, 31 3 1980"
      },
       errorMessage: {
            html: '<p class="govuk-error-message">' + t(errorFor('reportDetails['+reportDetailIndex+'][reportDate]')) + '</p>' +
            '<p class="govuk-error-message">' + t(errorFor('reportDetails['+reportDetailIndex+'][day]')) + '</p>' +
            '<p class="govuk-error-message">' + t(errorFor('reportDetails['+reportDetailIndex+'][month]')) + '</p>' +
            '<p class="govuk-error-message">' + t(errorFor('reportDetails['+reportDetailIndex+'][year]')) + '</p>'
          } if errorFor('reportDetails['+reportDetailIndex+'][reportDate]') or
          errorFor('reportDetails['+reportDetailIndex+'][day]') or
          errorFor('reportDetails['+reportDetailIndex+'][month]') or
          errorFor('reportDetails['+reportDetailIndex+'][year]'),
                items: [
                  {
                    classes: "govuk-input--width-2 govuk-input--error" if errorFor('reportDetails['+reportDetailIndex+'][day]') else "govuk-input--width-2",
                    id: 'reportDetails[' + reportDetailIndex + '][day]',
                    label: t('COMMON.DAY'),
                    name: 'reportDetails[' + reportDetailIndex + '][day]',
                    value: reportDetailValue.day,
                    max: 31
                  },
                  {
                    classes:"govuk-input--width-2 govuk-input--error" if errorFor('reportDetails['+reportDetailIndex+'][month]') else "govuk-input--width-2",
                    id: 'reportDetails[' + reportDetailIndex + '][month]',
                    label: t('COMMON.MONTH'),
                    name: 'reportDetails[' + reportDetailIndex + '][month]',
                    value: reportDetailValue.month,
                    max: 12
                  },
                  {
                    classes: "govuk-input--width-4 govuk-input--error" if errorFor('reportDetails['+reportDetailIndex+'][year]') else "govuk-input--width-4",
                    id: 'reportDetails[' + reportDetailIndex + '][year]',
                    label: t('COMMON.YEAR'),
                    name: 'reportDetails[' + reportDetailIndex + '][year]',
                    value: reportDetailValue.year,
                    max: 9999
                  }
                ]
              }) }}
  {% endcall %}
{% endmacro %}
